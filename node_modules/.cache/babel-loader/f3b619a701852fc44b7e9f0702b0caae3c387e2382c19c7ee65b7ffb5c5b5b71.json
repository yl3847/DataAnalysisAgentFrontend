{"ast":null,"code":"import { __assign, __extends, __read, __rest } from \"tslib\";\nimport { Component } from '../../core';\nimport { classNames, ifShow, select, splitStyle, subStyleProps } from '../../util';\nimport { HANDLE_DEFAULT_CFG, HANDLE_ICON_DEFAULT_CFG, HANDLE_LABEL_DEFAULT_CFG } from './constant';\nvar CLASS_NAMES = classNames({\n  labelGroup: 'label-group',\n  label: 'label',\n  iconGroup: 'icon-group',\n  icon: 'icon',\n  iconRect: 'icon-rect',\n  iconLine: 'icon-line'\n}, 'handle');\nvar HandleIcon = /** @class */function (_super) {\n  __extends(HandleIcon, _super);\n  function HandleIcon() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  HandleIcon.prototype.render = function (attributes, container) {\n    var x = attributes.x,\n      y = attributes.y,\n      _a = attributes.size,\n      size = _a === void 0 ? 10 : _a,\n      _b = attributes.radius,\n      radius = _b === void 0 ? size / 4 : _b,\n      orientation = attributes.orientation,\n      iconStyle = __rest(attributes, [\"x\", \"y\", \"size\", \"radius\", \"orientation\"]);\n    // 默认手柄\n    var width = size;\n    var height = width * 2.4;\n    var rect = select(container).maybeAppendByClassName(CLASS_NAMES.iconRect, 'rect').styles(__assign(__assign({}, iconStyle), {\n      width: width,\n      height: height,\n      radius: radius,\n      x: x - width / 2,\n      y: y - height / 2,\n      transformOrigin: 'center'\n    }));\n    var x1 = x + 1 / 3 * width - width / 2;\n    var x2 = x + 2 / 3 * width - width / 2;\n    var y1 = y + 1 / 4 * height - height / 2;\n    var y2 = y + 3 / 4 * height - height / 2;\n    rect.maybeAppendByClassName(\"\".concat(CLASS_NAMES.iconLine, \"-1\"), 'line').styles(__assign({\n      x1: x1,\n      x2: x1,\n      y1: y1,\n      y2: y2\n    }, iconStyle));\n    rect.maybeAppendByClassName(\"\".concat(CLASS_NAMES.iconLine, \"-2\"), 'line').styles(__assign({\n      x1: x2,\n      x2: x2,\n      y1: y1,\n      y2: y2\n    }, iconStyle));\n    if (orientation === 'vertical') rect.node().style.transform = 'rotate(90)';\n  };\n  return HandleIcon;\n}(Component);\nvar Handle = /** @class */function (_super) {\n  __extends(Handle, _super);\n  function Handle(options) {\n    return _super.call(this, options, HANDLE_DEFAULT_CFG) || this;\n  }\n  Handle.prototype.renderLabel = function (container) {\n    var _this = this;\n    var _a = this.attributes,\n      x = _a.x,\n      y = _a.y,\n      showLabel = _a.showLabel;\n    var _b = subStyleProps(this.attributes, 'label'),\n      _c = _b.x,\n      labelX = _c === void 0 ? 0 : _c,\n      _d = _b.y,\n      labelY = _d === void 0 ? 0 : _d,\n      transform = _b.transform,\n      transformOrigin = _b.transformOrigin,\n      style = __rest(_b, [\"x\", \"y\", \"transform\", \"transformOrigin\"]);\n    var _e = __read(splitStyle(style, []), 2),\n      labelStyle = _e[0],\n      groupStyle = _e[1];\n    var labelGroup = select(container).maybeAppendByClassName(CLASS_NAMES.labelGroup, 'g').styles(groupStyle);\n    // @ts-ignore\n    var _f = __assign(__assign({}, HANDLE_LABEL_DEFAULT_CFG), labelStyle),\n      text = _f.text,\n      rest = __rest(_f, [\"text\"]);\n    ifShow(!!showLabel, labelGroup, function (group) {\n      _this.label = group.maybeAppendByClassName(CLASS_NAMES.label, 'text').styles(__assign(__assign({}, rest), {\n        x: x + labelX,\n        y: y + labelY,\n        transform: transform,\n        transformOrigin: transformOrigin,\n        text: \"\".concat(text)\n      }));\n      /** avoid trigger event on label */\n      _this.label.on('mousedown', function (e) {\n        e.stopPropagation();\n      });\n      _this.label.on('touchstart', function (e) {\n        e.stopPropagation();\n      });\n    });\n  };\n  Handle.prototype.renderIcon = function (container) {\n    var _a = this.attributes,\n      x = _a.x,\n      y = _a.y,\n      orientation = _a.orientation,\n      type = _a.type;\n    var iconStyle = __assign(__assign({\n      x: x,\n      y: y,\n      orientation: orientation\n    }, HANDLE_ICON_DEFAULT_CFG), subStyleProps(this.attributes, 'icon'));\n    var _b = this.attributes.iconShape,\n      iconShape = _b === void 0 ? function () {\n        return new HandleIcon({\n          style: iconStyle\n        });\n      } : _b;\n    var iconGroup = select(container).maybeAppendByClassName(CLASS_NAMES.iconGroup, 'g');\n    iconGroup.selectAll(CLASS_NAMES.icon.class).data([iconShape]).join(function (enter) {\n      return enter.append(typeof iconShape === 'string' ? iconShape : function () {\n        return iconShape(type);\n      }).attr('className', CLASS_NAMES.icon.name);\n    }, function (update) {\n      return update.update(iconStyle);\n    }, function (exit) {\n      return exit.remove();\n    });\n  };\n  Handle.prototype.render = function (attributes, container) {\n    this.renderIcon(container);\n    this.renderLabel(container);\n  };\n  return Handle;\n}(Component);\nexport { Handle };","map":{"version":3,"names":["Component","classNames","ifShow","select","splitStyle","subStyleProps","HANDLE_DEFAULT_CFG","HANDLE_ICON_DEFAULT_CFG","HANDLE_LABEL_DEFAULT_CFG","CLASS_NAMES","labelGroup","label","iconGroup","icon","iconRect","iconLine","HandleIcon","_super","__extends","prototype","render","attributes","container","x","y","_a","size","_b","radius","orientation","iconStyle","__rest","width","height","rect","maybeAppendByClassName","styles","__assign","transformOrigin","x1","x2","y1","y2","concat","node","style","transform","Handle","options","call","renderLabel","_this","showLabel","_c","labelX","_d","labelY","_e","__read","labelStyle","groupStyle","_f","text","rest","group","on","e","stopPropagation","renderIcon","type","iconShape","selectAll","class","data","join","enter","append","attr","name","update","exit","remove"],"sources":["/Users/yizelu/Desktop/mcp/frontend/node_modules/@antv/component/src/ui/slider/handle.ts"],"sourcesContent":["import { ComponentOptions, Component, PrefixStyleProps } from '../../core';\nimport type { DisplayObject, GroupStyleProps, PathStyleProps, TextStyleProps } from '../../shapes';\nimport { Group } from '../../shapes';\nimport type { Selection } from '../../util';\nimport { classNames, ifShow, select, splitStyle, subStyleProps } from '../../util';\nimport { HANDLE_DEFAULT_CFG, HANDLE_ICON_DEFAULT_CFG, HANDLE_LABEL_DEFAULT_CFG } from './constant';\n\nexport type HandleType = 'start' | 'end';\n\nexport type IconStyleProps = PathStyleProps & {\n  x?: number;\n  y?: number;\n  size?: number;\n  radius?: number;\n  shape?: string | ((type: HandleType) => DisplayObject);\n  orientation?: 'horizontal' | 'vertical';\n};\n\nexport type LabelStyleProps = Partial<TextStyleProps>;\n\nexport type HandleStyleProps = GroupStyleProps &\n  PrefixStyleProps<LabelStyleProps, 'label'> &\n  PrefixStyleProps<IconStyleProps, 'icon'> & {\n    x?: number;\n    y?: number;\n    orientation?: IconStyleProps['orientation'];\n    showLabel?: boolean;\n    spacing?: number;\n    type?: HandleType;\n  };\n\nexport type HandleOptions = ComponentOptions<HandleStyleProps>;\n\nconst CLASS_NAMES = classNames(\n  {\n    labelGroup: 'label-group',\n    label: 'label',\n    iconGroup: 'icon-group',\n    icon: 'icon',\n    iconRect: 'icon-rect',\n    iconLine: 'icon-line',\n  },\n  'handle'\n);\n\nclass HandleIcon extends Component<IconStyleProps> {\n  render(attributes: Required<IconStyleProps>, container: DisplayObject) {\n    const { x, y, size = 10, radius = size / 4, orientation, ...iconStyle } = attributes;\n    // 默认手柄\n    const width = size!;\n    const height = width * 2.4;\n\n    const rect = select(container)\n      .maybeAppendByClassName(CLASS_NAMES.iconRect, 'rect')\n      .styles({\n        ...iconStyle,\n        width,\n        height,\n        radius,\n        x: x - width / 2,\n        y: y - height / 2,\n        transformOrigin: 'center',\n      });\n\n    const x1 = x + (1 / 3) * width - width / 2;\n    const x2 = x + (2 / 3) * width - width / 2;\n    const y1 = y + (1 / 4) * height - height / 2;\n    const y2 = y + (3 / 4) * height - height / 2;\n\n    rect.maybeAppendByClassName(`${CLASS_NAMES.iconLine}-1`, 'line').styles({ x1, x2: x1, y1, y2, ...iconStyle });\n    rect.maybeAppendByClassName(`${CLASS_NAMES.iconLine}-2`, 'line').styles({ x1: x2, x2, y1, y2, ...iconStyle });\n\n    if (orientation === 'vertical') rect.node().style.transform = 'rotate(90)';\n  }\n}\n\nexport class Handle extends Component<HandleStyleProps> {\n  private label!: Selection;\n\n  private icon!: Selection;\n\n  constructor(options: HandleOptions) {\n    super(options, HANDLE_DEFAULT_CFG);\n  }\n\n  private renderLabel(container: Group) {\n    const { x, y, showLabel } = this.attributes;\n    const {\n      x: labelX = 0,\n      y: labelY = 0,\n      transform,\n      transformOrigin,\n      ...style\n    } = subStyleProps(this.attributes, 'label');\n    const [labelStyle, groupStyle] = splitStyle(style, []);\n\n    const labelGroup = select(container).maybeAppendByClassName(CLASS_NAMES.labelGroup, 'g').styles(groupStyle);\n\n    // @ts-ignore\n    const { text, ...rest } = { ...HANDLE_LABEL_DEFAULT_CFG, ...labelStyle };\n    ifShow(!!showLabel, labelGroup, (group) => {\n      this.label = group.maybeAppendByClassName(CLASS_NAMES.label, 'text').styles({\n        ...rest,\n        x: x + labelX,\n        y: y + labelY,\n        transform,\n        transformOrigin,\n        text: `${text}`,\n      });\n\n      /** avoid trigger event on label */\n      this.label.on('mousedown', (e: MouseEvent) => {\n        e.stopPropagation();\n      });\n      this.label.on('touchstart', (e: MouseEvent) => {\n        e.stopPropagation();\n      });\n    });\n  }\n\n  private renderIcon(container: Group) {\n    const { x, y, orientation, type } = this.attributes;\n    const iconStyle = { x, y, orientation, ...HANDLE_ICON_DEFAULT_CFG, ...subStyleProps(this.attributes, 'icon') };\n    const { iconShape = () => new HandleIcon({ style: iconStyle }) } = this.attributes;\n    const iconGroup = select(container).maybeAppendByClassName(CLASS_NAMES.iconGroup, 'g');\n    iconGroup\n      .selectAll(CLASS_NAMES.icon.class)\n      .data([iconShape])\n      .join(\n        (enter) =>\n          enter\n            .append(typeof iconShape === 'string' ? iconShape : () => iconShape(type))\n            .attr('className', CLASS_NAMES.icon.name),\n        (update) => update.update(iconStyle),\n        (exit) => exit.remove()\n      );\n  }\n\n  public render(attributes: HandleStyleProps, container: Group) {\n    this.renderIcon(container);\n    this.renderLabel(container);\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}