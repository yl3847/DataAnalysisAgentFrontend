{"ast":null,"code":"import { BaseTransform, idOf } from '@antv/g6';\nimport { get, has, set } from 'lodash';\nimport React from 'react';\nimport { CollapseExpandIcon } from '../base';\nimport { withCollapsibleNode } from '../hoc';\nimport { getNeighborNodeIds } from '../utils/data';\nconst {\n  PlusMinusIcon\n} = CollapseExpandIcon;\nexport class CollapseExpandReactNode extends BaseTransform {\n  static defaultOptions = {\n    enable: true,\n    trigger: 'icon',\n    direction: 'out',\n    iconRender: isCollapsed => React.createElement(PlusMinusIcon, {\n      isCollapsed: isCollapsed\n    }),\n    iconPlacement: 'bottom',\n    iconOffsetX: 0,\n    iconOffsetY: 0,\n    iconClassName: '',\n    iconStyle: {},\n    refreshLayout: false\n  };\n  constructor(context, options) {\n    super(context, Object.assign({}, CollapseExpandReactNode.defaultOptions, options));\n  }\n  afterLayout() {\n    const {\n      graph,\n      element,\n      model\n    } = this.context;\n    const {\n      nodes = [],\n      edges = []\n    } = graph.getData();\n    const {\n      enable,\n      ...options\n    } = this.options;\n    nodes.forEach(datum => {\n      const nodeId = idOf(datum);\n      const node = element.getElement(nodeId);\n      if (!node || datum.children && datum.children.length > 0) return;\n      const children = getNeighborNodeIds(nodeId, edges, this.options.direction);\n      if (children.length === 0) return;\n      model.updateNodeData([{\n        id: nodeId,\n        children\n      }]);\n    });\n    const nodeMapper = graph.getOptions().node;\n    if (has(nodeMapper, 'style.component')) {\n      const Component = get(nodeMapper, 'style.component');\n      set(nodeMapper, 'style.component', data => {\n        if (!(typeof enable === 'function' ? enable(data) : enable)) return Component.call(graph, data);\n        const CollapsibleNode = withCollapsibleNode(Component);\n        return React.createElement(CollapsibleNode, {\n          data: data,\n          graph: graph,\n          ...options\n        });\n      });\n    }\n    graph.setNode(nodeMapper);\n    graph.draw();\n  }\n}","map":{"version":3,"names":["BaseTransform","idOf","get","has","set","React","CollapseExpandIcon","withCollapsibleNode","getNeighborNodeIds","PlusMinusIcon","CollapseExpandReactNode","defaultOptions","enable","trigger","direction","iconRender","isCollapsed","createElement","iconPlacement","iconOffsetX","iconOffsetY","iconClassName","iconStyle","refreshLayout","constructor","context","options","Object","assign","afterLayout","graph","element","model","nodes","edges","getData","forEach","datum","nodeId","node","getElement","children","length","updateNodeData","id","nodeMapper","getOptions","Component","data","call","CollapsibleNode","setNode","draw"],"sources":["/Users/yizelu/Desktop/mcp/frontend/node_modules/@ant-design/graphs/es/core/transform/collapse-expand-react-node.js"],"sourcesContent":["import { BaseTransform, idOf } from '@antv/g6';\nimport { get, has, set } from 'lodash';\nimport React from 'react';\nimport { CollapseExpandIcon } from '../base';\nimport { withCollapsibleNode } from '../hoc';\nimport { getNeighborNodeIds } from '../utils/data';\nconst { PlusMinusIcon } = CollapseExpandIcon;\nexport class CollapseExpandReactNode extends BaseTransform {\n    static defaultOptions = {\n        enable: true,\n        trigger: 'icon',\n        direction: 'out',\n        iconRender: (isCollapsed) => React.createElement(PlusMinusIcon, { isCollapsed: isCollapsed }),\n        iconPlacement: 'bottom',\n        iconOffsetX: 0,\n        iconOffsetY: 0,\n        iconClassName: '',\n        iconStyle: {},\n        refreshLayout: false,\n    };\n    constructor(context, options) {\n        super(context, Object.assign({}, CollapseExpandReactNode.defaultOptions, options));\n    }\n    afterLayout() {\n        const { graph, element, model } = this.context;\n        const { nodes = [], edges = [] } = graph.getData();\n        const { enable, ...options } = this.options;\n        nodes.forEach((datum) => {\n            const nodeId = idOf(datum);\n            const node = element.getElement(nodeId);\n            if (!node || (datum.children && datum.children.length > 0))\n                return;\n            const children = getNeighborNodeIds(nodeId, edges, this.options.direction);\n            if (children.length === 0)\n                return;\n            model.updateNodeData([{ id: nodeId, children }]);\n        });\n        const nodeMapper = graph.getOptions().node;\n        if (has(nodeMapper, 'style.component')) {\n            const Component = get(nodeMapper, 'style.component');\n            set(nodeMapper, 'style.component', (data) => {\n                if (!(typeof enable === 'function' ? enable(data) : enable))\n                    return Component.call(graph, data);\n                const CollapsibleNode = withCollapsibleNode(Component);\n                return React.createElement(CollapsibleNode, { data: data, graph: graph, ...options });\n            });\n        }\n        graph.setNode(nodeMapper);\n        graph.draw();\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}