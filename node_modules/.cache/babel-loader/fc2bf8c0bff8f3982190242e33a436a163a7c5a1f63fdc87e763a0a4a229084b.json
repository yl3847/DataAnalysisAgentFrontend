{"ast":null,"code":"import { idOf } from '@antv/g6';\nimport { get, isEmpty } from 'lodash';\nimport React, { useEffect, useRef, useState } from 'react';\nimport styled, { css } from 'styled-components';\nconst StyledWrapper = styled.div`\n  position: relative;\n  height: inherit;\n  width: inherit;\n`;\nconst StyledIconWrapper = styled.div`\n  position: absolute;\n  z-index: 10;\n\n  &:hover {\n    cursor: pointer;\n  }\n\n  ${({\n  $placement,\n  $offsetX,\n  $offsetY\n}) => {\n  const positions = {\n    top: `left: calc(50% + ${$offsetX}px); top: ${$offsetY}px;`,\n    bottom: `left: calc(50% + ${$offsetX}px); top: calc(100% + ${$offsetY}px);`,\n    right: `left: calc(100% + ${$offsetX}px); top: calc(50% + ${$offsetY}px);`,\n    left: `left: ${$offsetX}px; top: calc(50% + ${$offsetY}px);`\n  };\n  return css`\n      ${positions[$placement]}\n    `;\n}}\n`;\nexport const withCollapsibleNode = NodeComponent => {\n  return props => {\n    const {\n      data,\n      graph,\n      trigger,\n      iconRender,\n      iconPlacement,\n      iconOffsetX,\n      iconOffsetY,\n      iconClassName,\n      iconStyle,\n      refreshLayout\n    } = props;\n    const [isCollapsed, setIsCollapsed] = useState(get(data, 'style.collapsed', false));\n    const wrapperRef = useRef(null);\n    const iconRef = useRef(null);\n    const isIconShown = trigger === 'icon' && !isEmpty(data.children);\n    const handleClickCollapse = async e => {\n      e.stopPropagation();\n      const toggleExpandCollapse = isCollapsed ? 'expandElement' : 'collapseElement';\n      await graph[toggleExpandCollapse](idOf(data));\n      setIsCollapsed(prev => !prev);\n      if (refreshLayout) {\n        await graph.layout();\n      }\n    };\n    useEffect(() => {\n      const target = trigger === 'icon' ? iconRef.current : trigger === 'node' ? wrapperRef.current : trigger;\n      target?.addEventListener('click', handleClickCollapse);\n      return () => {\n        target?.removeEventListener('click', handleClickCollapse);\n      };\n    }, [trigger, isCollapsed]);\n    const computeCallbackStyle = callableStyle => {\n      return typeof callableStyle === 'function' ? callableStyle.call(graph, data) : callableStyle;\n    };\n    return React.createElement(StyledWrapper, {\n      ref: wrapperRef,\n      className: \"collapsible-node-wrapper\"\n    }, isIconShown && React.createElement(StyledIconWrapper, {\n      ref: iconRef,\n      \"$placement\": computeCallbackStyle(iconPlacement),\n      \"$offsetX\": computeCallbackStyle(iconOffsetX),\n      \"$offsetY\": computeCallbackStyle(iconOffsetY),\n      className: iconClassName,\n      style: iconStyle\n    }, iconRender?.call(graph, isCollapsed, data)), NodeComponent.call(graph, data));\n  };\n};","map":{"version":3,"names":["idOf","get","isEmpty","React","useEffect","useRef","useState","styled","css","StyledWrapper","div","StyledIconWrapper","$placement","$offsetX","$offsetY","positions","top","bottom","right","left","withCollapsibleNode","NodeComponent","props","data","graph","trigger","iconRender","iconPlacement","iconOffsetX","iconOffsetY","iconClassName","iconStyle","refreshLayout","isCollapsed","setIsCollapsed","wrapperRef","iconRef","isIconShown","children","handleClickCollapse","e","stopPropagation","toggleExpandCollapse","prev","layout","target","current","addEventListener","removeEventListener","computeCallbackStyle","callableStyle","call","createElement","ref","className","style"],"sources":["/Users/yizelu/Desktop/mcp/frontend/node_modules/@ant-design/graphs/es/core/hoc/with-collapsible-node.js"],"sourcesContent":["import { idOf } from '@antv/g6';\nimport { get, isEmpty } from 'lodash';\nimport React, { useEffect, useRef, useState } from 'react';\nimport styled, { css } from 'styled-components';\nconst StyledWrapper = styled.div `\n  position: relative;\n  height: inherit;\n  width: inherit;\n`;\nconst StyledIconWrapper = styled.div `\n  position: absolute;\n  z-index: 10;\n\n  &:hover {\n    cursor: pointer;\n  }\n\n  ${({ $placement, $offsetX, $offsetY }) => {\n    const positions = {\n        top: `left: calc(50% + ${$offsetX}px); top: ${$offsetY}px;`,\n        bottom: `left: calc(50% + ${$offsetX}px); top: calc(100% + ${$offsetY}px);`,\n        right: `left: calc(100% + ${$offsetX}px); top: calc(50% + ${$offsetY}px);`,\n        left: `left: ${$offsetX}px; top: calc(50% + ${$offsetY}px);`,\n    };\n    return css `\n      ${positions[$placement]}\n    `;\n}}\n`;\nexport const withCollapsibleNode = (NodeComponent) => {\n    return (props) => {\n        const { data, graph, trigger, iconRender, iconPlacement, iconOffsetX, iconOffsetY, iconClassName, iconStyle, refreshLayout, } = props;\n        const [isCollapsed, setIsCollapsed] = useState(get(data, 'style.collapsed', false));\n        const wrapperRef = useRef(null);\n        const iconRef = useRef(null);\n        const isIconShown = trigger === 'icon' && !isEmpty(data.children);\n        const handleClickCollapse = async (e) => {\n            e.stopPropagation();\n            const toggleExpandCollapse = isCollapsed ? 'expandElement' : 'collapseElement';\n            await graph[toggleExpandCollapse](idOf(data));\n            setIsCollapsed((prev) => !prev);\n            if (refreshLayout) {\n                await graph.layout();\n            }\n        };\n        useEffect(() => {\n            const target = trigger === 'icon' ? iconRef.current : trigger === 'node' ? wrapperRef.current : trigger;\n            target?.addEventListener('click', handleClickCollapse);\n            return () => {\n                target?.removeEventListener('click', handleClickCollapse);\n            };\n        }, [trigger, isCollapsed]);\n        const computeCallbackStyle = (callableStyle) => {\n            return typeof callableStyle === 'function' ? callableStyle.call(graph, data) : callableStyle;\n        };\n        return (React.createElement(StyledWrapper, { ref: wrapperRef, className: \"collapsible-node-wrapper\" },\n            isIconShown && (React.createElement(StyledIconWrapper, { ref: iconRef, \"$placement\": computeCallbackStyle(iconPlacement), \"$offsetX\": computeCallbackStyle(iconOffsetX), \"$offsetY\": computeCallbackStyle(iconOffsetY), className: iconClassName, style: iconStyle }, iconRender?.call(graph, isCollapsed, data))),\n            NodeComponent.call(graph, data)));\n    };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}