{"ast":null,"code":"import { deepMix } from '@antv/util';\nimport { isUnset } from '../utils/helper';\nimport { dynamicFormatDateTime } from '../utils/dateFormat';\nimport { columnOf } from './utils/helper';\n/**\n * Infer title channel from x-position channel.\n */\nexport const MaybeTitle = (options = {}) => {\n  const {\n    channel = 'x'\n  } = options;\n  return (I, mark) => {\n    const {\n      encode\n    } = mark;\n    const {\n      tooltip\n    } = mark;\n    if (isUnset(tooltip)) return [I, mark];\n    const {\n      title\n    } = tooltip;\n    if (title !== undefined) return [I, mark];\n    const titles = Object.keys(encode).filter(key => key.startsWith(channel)).filter(key => !encode[key].inferred).map(key => columnOf(encode, key)).filter(([T]) => T).map(d => d[0]);\n    if (titles.length === 0) return [I, mark];\n    const T = [];\n    for (const i of I) {\n      T[i] = {\n        value: titles.map(t => t[i] instanceof Date ? dynamicFormatDateTime(t[i]) : t[i]).join(', ')\n      };\n    }\n    return [I, deepMix({}, mark, {\n      tooltip: {\n        title: T\n      }\n    })];\n  };\n};\nMaybeTitle.props = {};","map":{"version":3,"names":["deepMix","isUnset","dynamicFormatDateTime","columnOf","MaybeTitle","options","channel","I","mark","encode","tooltip","title","undefined","titles","Object","keys","filter","key","startsWith","inferred","map","T","d","length","i","value","t","Date","join","props"],"sources":["/Users/yizelu/Desktop/mcp/frontend/node_modules/@antv/g2/src/transform/maybeTitle.ts"],"sourcesContent":["import { deepMix } from '@antv/util';\nimport { isUnset } from '../utils/helper';\nimport { TransformComponent as TC } from '../runtime';\nimport { dynamicFormatDateTime } from '../utils/dateFormat';\nimport { columnOf } from './utils/helper';\n\nexport type MaybeTitleOptions = {\n  channel?: string;\n};\n\n/**\n * Infer title channel from x-position channel.\n */\nexport const MaybeTitle: TC<MaybeTitleOptions> = (options = {}) => {\n  const { channel = 'x' } = options;\n  return (I, mark) => {\n    const { encode } = mark;\n    const { tooltip } = mark;\n    if (isUnset(tooltip)) return [I, mark];\n    const { title } = tooltip;\n    if (title !== undefined) return [I, mark];\n    const titles = Object.keys(encode)\n      .filter((key) => key.startsWith(channel))\n      .filter((key) => !encode[key].inferred)\n      .map((key) => columnOf(encode, key))\n      .filter(([T]) => T)\n      .map((d) => d[0]);\n    if (titles.length === 0) return [I, mark];\n    const T = [];\n    for (const i of I) {\n      T[i] = {\n        value: titles\n          .map((t) =>\n            t[i] instanceof Date ? dynamicFormatDateTime(t[i] as Date) : t[i],\n          )\n          .join(', '),\n      };\n    }\n    return [\n      I,\n      deepMix({}, mark, {\n        tooltip: {\n          title: T,\n        },\n      }),\n    ];\n  };\n};\n\nMaybeTitle.props = {};\n"],"mappings":"AAAA,SAASA,OAAO,QAAQ,YAAY;AACpC,SAASC,OAAO,QAAQ,iBAAiB;AAEzC,SAASC,qBAAqB,QAAQ,qBAAqB;AAC3D,SAASC,QAAQ,QAAQ,gBAAgB;AAMzC;;;AAGA,OAAO,MAAMC,UAAU,GAA0BA,CAACC,OAAO,GAAG,EAAE,KAAI;EAChE,MAAM;IAAEC,OAAO,GAAG;EAAG,CAAE,GAAGD,OAAO;EACjC,OAAO,CAACE,CAAC,EAAEC,IAAI,KAAI;IACjB,MAAM;MAAEC;IAAM,CAAE,GAAGD,IAAI;IACvB,MAAM;MAAEE;IAAO,CAAE,GAAGF,IAAI;IACxB,IAAIP,OAAO,CAACS,OAAO,CAAC,EAAE,OAAO,CAACH,CAAC,EAAEC,IAAI,CAAC;IACtC,MAAM;MAAEG;IAAK,CAAE,GAAGD,OAAO;IACzB,IAAIC,KAAK,KAAKC,SAAS,EAAE,OAAO,CAACL,CAAC,EAAEC,IAAI,CAAC;IACzC,MAAMK,MAAM,GAAGC,MAAM,CAACC,IAAI,CAACN,MAAM,CAAC,CAC/BO,MAAM,CAAEC,GAAG,IAAKA,GAAG,CAACC,UAAU,CAACZ,OAAO,CAAC,CAAC,CACxCU,MAAM,CAAEC,GAAG,IAAK,CAACR,MAAM,CAACQ,GAAG,CAAC,CAACE,QAAQ,CAAC,CACtCC,GAAG,CAAEH,GAAG,IAAKd,QAAQ,CAACM,MAAM,EAAEQ,GAAG,CAAC,CAAC,CACnCD,MAAM,CAAC,CAAC,CAACK,CAAC,CAAC,KAAKA,CAAC,CAAC,CAClBD,GAAG,CAAEE,CAAC,IAAKA,CAAC,CAAC,CAAC,CAAC,CAAC;IACnB,IAAIT,MAAM,CAACU,MAAM,KAAK,CAAC,EAAE,OAAO,CAAChB,CAAC,EAAEC,IAAI,CAAC;IACzC,MAAMa,CAAC,GAAG,EAAE;IACZ,KAAK,MAAMG,CAAC,IAAIjB,CAAC,EAAE;MACjBc,CAAC,CAACG,CAAC,CAAC,GAAG;QACLC,KAAK,EAAEZ,MAAM,CACVO,GAAG,CAAEM,CAAC,IACLA,CAAC,CAACF,CAAC,CAAC,YAAYG,IAAI,GAAGzB,qBAAqB,CAACwB,CAAC,CAACF,CAAC,CAAS,CAAC,GAAGE,CAAC,CAACF,CAAC,CAAC,CAClE,CACAI,IAAI,CAAC,IAAI;OACb;;IAEH,OAAO,CACLrB,CAAC,EACDP,OAAO,CAAC,EAAE,EAAEQ,IAAI,EAAE;MAChBE,OAAO,EAAE;QACPC,KAAK,EAAEU;;KAEV,CAAC,CACH;EACH,CAAC;AACH,CAAC;AAEDjB,UAAU,CAACyB,KAAK,GAAG,EAAE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}