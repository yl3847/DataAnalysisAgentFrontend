{"ast":null,"code":"import { flow, transformOptions, set, groupBy } from '../../utils';\nimport { mark } from '../../adaptor';\n/**\n * @param chart\n * @param options\n */\nexport function adaptor(params) {\n  /**\n   * 图表差异化处理\n   */\n  var init = function (params) {\n    var options = params.options;\n    var xField = options.xField,\n      colorField = options.colorField;\n    if (!colorField) {\n      set(options, 'colorField', xField);\n    }\n    return params;\n  };\n  var transform = function (params) {\n    var options = params.options;\n    var compareField = options.compareField,\n      transform = options.transform,\n      _a = options.isTransposed,\n      isTransposed = _a === void 0 ? true : _a,\n      coordinate = options.coordinate;\n    if (!transform) {\n      if (compareField) {\n        set(options, 'transform', []);\n      } else {\n        set(options, 'transform', [{\n          type: 'symmetryY'\n        }]);\n      }\n    }\n    if (!coordinate && isTransposed) {\n      set(options, 'coordinate', {\n        transform: [{\n          type: 'transpose'\n        }]\n      });\n    }\n    return params;\n  };\n  var compare = function (params) {\n    var options = params.options;\n    var compareField = options.compareField,\n      seriesField = options.seriesField,\n      data = options.data,\n      children = options.children,\n      yField = options.yField,\n      _a = options.isTransposed,\n      isTransposed = _a === void 0 ? true : _a;\n    if (compareField || seriesField) {\n      var groupedData = Object.values(groupBy(data, function (item) {\n        return item[compareField || seriesField];\n      }));\n      children[0].data = groupedData[0];\n      children.push({\n        type: 'interval',\n        data: groupedData[1],\n        // @ts-ignore\n        yField: function (item) {\n          return -item[yField];\n        }\n      });\n      delete options['compareField'];\n      delete options.data;\n    }\n    if (seriesField) {\n      set(options, 'type', 'spaceFlex');\n      set(options, 'ratio', [1, 1]);\n      set(options, 'direction', isTransposed ? 'row' : 'col');\n      delete options['seriesField'];\n    }\n    return params;\n  };\n  var tooltip = function (params) {\n    var options = params.options;\n    var tooltip = options.tooltip,\n      xField = options.xField,\n      yField = options.yField;\n    if (!tooltip) {\n      set(options, 'tooltip', {\n        title: false,\n        items: [function (d) {\n          return {\n            name: d[xField],\n            value: d[yField]\n          };\n        }]\n      });\n    }\n    return params;\n  };\n  return flow(init, transform, compare, tooltip, mark, transformOptions)(params);\n}","map":{"version":3,"names":["flow","transformOptions","set","groupBy","mark","adaptor","params","init","options","xField","colorField","transform","compareField","_a","isTransposed","coordinate","type","compare","seriesField","data","children","yField","groupedData","Object","values","item","push","tooltip","title","items","d","name","value"],"sources":["/Users/yizelu/Desktop/mcp/frontend/node_modules/@ant-design/plots/es/core/plots/funnel/adaptor.js"],"sourcesContent":["import { flow, transformOptions, set, groupBy } from '../../utils';\nimport { mark } from '../../adaptor';\n/**\n * @param chart\n * @param options\n */\nexport function adaptor(params) {\n    /**\n     * 图表差异化处理\n     */\n    var init = function (params) {\n        var options = params.options;\n        var xField = options.xField, colorField = options.colorField;\n        if (!colorField) {\n            set(options, 'colorField', xField);\n        }\n        return params;\n    };\n    var transform = function (params) {\n        var options = params.options;\n        var compareField = options.compareField, transform = options.transform, _a = options.isTransposed, isTransposed = _a === void 0 ? true : _a, coordinate = options.coordinate;\n        if (!transform) {\n            if (compareField) {\n                set(options, 'transform', []);\n            }\n            else {\n                set(options, 'transform', [{ type: 'symmetryY' }]);\n            }\n        }\n        if (!coordinate && isTransposed) {\n            set(options, 'coordinate', { transform: [{ type: 'transpose' }] });\n        }\n        return params;\n    };\n    var compare = function (params) {\n        var options = params.options;\n        var compareField = options.compareField, seriesField = options.seriesField, data = options.data, children = options.children, yField = options.yField, _a = options.isTransposed, isTransposed = _a === void 0 ? true : _a;\n        if (compareField || seriesField) {\n            var groupedData = Object.values(groupBy(data, function (item) { return item[compareField || seriesField]; }));\n            children[0].data = groupedData[0];\n            children.push({\n                type: 'interval',\n                data: groupedData[1],\n                // @ts-ignore\n                yField: function (item) { return -item[yField]; },\n            });\n            delete options['compareField'];\n            delete options.data;\n        }\n        if (seriesField) {\n            set(options, 'type', 'spaceFlex');\n            set(options, 'ratio', [1, 1]);\n            set(options, 'direction', isTransposed ? 'row' : 'col');\n            delete options['seriesField'];\n        }\n        return params;\n    };\n    var tooltip = function (params) {\n        var options = params.options;\n        var tooltip = options.tooltip, xField = options.xField, yField = options.yField;\n        if (!tooltip) {\n            set(options, 'tooltip', {\n                title: false,\n                items: [\n                    function (d) {\n                        return { name: d[xField], value: d[yField] };\n                    },\n                ],\n            });\n        }\n        return params;\n    };\n    return flow(init, transform, compare, tooltip, mark, transformOptions)(params);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}