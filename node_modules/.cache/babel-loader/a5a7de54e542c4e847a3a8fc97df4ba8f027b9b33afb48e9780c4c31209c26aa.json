{"ast":null,"code":"import { __extends, __read } from \"tslib\";\nimport { ElementEvent } from '@antv/g';\nimport { Group } from '../../shapes';\nimport { BBox } from '../../util';\nimport { calcLayout } from '../../util/layout';\nimport { parseSeriesAttr } from '../../util/series';\nvar Layout = /** @class */function (_super) {\n  __extends(Layout, _super);\n  function Layout(options) {\n    var _this = _super.call(this, options) || this;\n    _this.layoutEvents = [ElementEvent.BOUNDS_CHANGED, ElementEvent.INSERTED, ElementEvent.REMOVED];\n    _this.$margin = parseSeriesAttr(0);\n    _this.$padding = parseSeriesAttr(0);\n    var _a = options.style || {},\n      _b = _a.margin,\n      margin = _b === void 0 ? 0 : _b,\n      _c = _a.padding,\n      padding = _c === void 0 ? 0 : _c;\n    _this.margin = margin;\n    _this.padding = padding;\n    _this.isMutationObserved = true;\n    _this.bindEvents();\n    return _this;\n  }\n  Object.defineProperty(Layout.prototype, \"margin\", {\n    get: function () {\n      return this.$margin;\n    },\n    set: function (value) {\n      this.$margin = parseSeriesAttr(value);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Layout.prototype, \"padding\", {\n    get: function () {\n      return this.$padding;\n    },\n    set: function (value) {\n      this.$padding = parseSeriesAttr(value);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Layout.prototype.getBBox = function () {\n    var _a = this.attributes,\n      _b = _a.x,\n      x = _b === void 0 ? 0 : _b,\n      _c = _a.y,\n      y = _c === void 0 ? 0 : _c,\n      width = _a.width,\n      height = _a.height;\n    var _d = __read(this.$margin, 4),\n      marginTop = _d[0],\n      marginRight = _d[1],\n      marginBottom = _d[2],\n      marginLeft = _d[3];\n    return new BBox(x - marginLeft, y - marginTop, width + marginLeft + marginRight, height + marginTop + marginBottom);\n  };\n  Layout.prototype.appendChild = function (child, index) {\n    child.isMutationObserved = true;\n    _super.prototype.appendChild.call(this, child, index);\n    return child;\n  };\n  Layout.prototype.getAvailableSpace = function () {\n    var _a = this.attributes,\n      width = _a.width,\n      height = _a.height;\n    var _b = __read(this.$padding, 4),\n      paddingTop = _b[0],\n      paddingRight = _b[1],\n      paddingBottom = _b[2],\n      paddingLeft = _b[3];\n    var _c = __read(this.$margin, 4),\n      marginTop = _c[0],\n      marginLeft = _c[3];\n    return new BBox(paddingLeft + marginLeft, paddingTop + marginTop, width - paddingLeft - paddingRight, height - paddingTop - paddingBottom);\n  };\n  Layout.prototype.layout = function () {\n    if (!this.attributes.display || !this.isConnected) return;\n    if (this.children.some(function (child) {\n      return !child.isConnected;\n    })) return;\n    try {\n      var _a = this.attributes,\n        x = _a.x,\n        y = _a.y;\n      this.style.transform = \"translate(\".concat(x, \", \").concat(y, \")\");\n      var bboxes_1 = calcLayout(this.getAvailableSpace(), this.children.map(function (child) {\n        return child.getBBox();\n      }), this.attributes);\n      this.children.forEach(function (child, index) {\n        var _a = bboxes_1[index],\n          x = _a.x,\n          y = _a.y;\n        child.style.transform = \"translate(\".concat(x, \", \").concat(y, \")\");\n      });\n    } catch (e) {\n      // do nothing\n    }\n  };\n  Layout.prototype.bindEvents = function () {\n    var _this = this;\n    this.layoutEvents.forEach(function (event) {\n      _this.addEventListener(event, function (e) {\n        if (!e.target) return;\n        e.target.isMutationObserved = true;\n        _this.layout();\n      });\n    });\n  };\n  Layout.prototype.attributeChangedCallback = function (name, oldValue, newValue) {\n    if (name === 'margin') this.margin = newValue;else if (name === 'padding') this.padding = newValue;\n    this.layout();\n  };\n  return Layout;\n}(Group);\nexport { Layout };","map":{"version":3,"names":["ElementEvent","Group","BBox","calcLayout","parseSeriesAttr","Layout","_super","__extends","options","_this","call","layoutEvents","BOUNDS_CHANGED","INSERTED","REMOVED","$margin","$padding","_a","style","_b","margin","_c","padding","isMutationObserved","bindEvents","Object","defineProperty","prototype","get","set","value","getBBox","attributes","x","y","width","height","_d","__read","marginTop","marginRight","marginBottom","marginLeft","appendChild","child","index","getAvailableSpace","paddingTop","paddingRight","paddingBottom","paddingLeft","layout","display","isConnected","children","some","transform","concat","bboxes_1","map","forEach","e","event","addEventListener","target","attributeChangedCallback","name","oldValue","newValue"],"sources":["/Users/yizelu/Desktop/mcp/frontend/node_modules/@antv/component/src/ui/layout/layout.ts"],"sourcesContent":["import type { FederatedEvent, INode } from '@antv/g';\nimport { ElementEvent } from '@antv/g';\nimport type { DisplayObject } from '../../shapes';\nimport { Group } from '../../shapes';\nimport { BBox } from '../../util';\nimport { calcLayout } from '../../util/layout';\nimport type { SeriesAttr, StandardSeriesAttr } from '../../util/series';\nimport { parseSeriesAttr } from '../../util/series';\nimport type { LayoutOptions, LayoutStyleProps } from './types';\n\nexport type { LayoutOptions, LayoutStyleProps };\n\nexport class Layout extends Group {\n  private layoutEvents: ElementEvent[] = [ElementEvent.BOUNDS_CHANGED, ElementEvent.INSERTED, ElementEvent.REMOVED];\n\n  private $margin: StandardSeriesAttr = parseSeriesAttr(0);\n\n  private $padding: StandardSeriesAttr = parseSeriesAttr(0);\n\n  public set margin(value: SeriesAttr) {\n    this.$margin = parseSeriesAttr(value);\n  }\n\n  public get margin() {\n    return this.$margin;\n  }\n\n  public set padding(value: SeriesAttr) {\n    this.$padding = parseSeriesAttr(value);\n  }\n\n  public get padding() {\n    return this.$padding;\n  }\n\n  public getBBox() {\n    const { x = 0, y = 0, width, height } = this.attributes;\n    const [marginTop, marginRight, marginBottom, marginLeft] = this.$margin;\n    return new BBox(x - marginLeft, y - marginTop, width + marginLeft + marginRight, height + marginTop + marginBottom);\n  }\n\n  public appendChild<T extends INode>(child: T, index?: number): T {\n    (child as unknown as DisplayObject).isMutationObserved = true;\n    super.appendChild(child, index);\n    return child;\n  }\n\n  public getAvailableSpace() {\n    const { width, height } = this.attributes;\n    const [paddingTop, paddingRight, paddingBottom, paddingLeft] = this.$padding;\n    const [marginTop, , , marginLeft] = this.$margin;\n    return new BBox(\n      paddingLeft + marginLeft,\n      paddingTop + marginTop,\n      width - paddingLeft - paddingRight,\n      height - paddingTop - paddingBottom\n    );\n  }\n\n  constructor(options: LayoutOptions) {\n    super(options);\n    const { margin = 0, padding = 0 } = options.style || {};\n    this.margin = margin;\n    this.padding = padding;\n\n    this.isMutationObserved = true;\n    this.bindEvents();\n  }\n\n  layout() {\n    if (!this.attributes.display || !this.isConnected) return;\n    if (this.children.some((child) => !child.isConnected)) return;\n    try {\n      const { x, y } = this.attributes;\n      this.style.transform = `translate(${x}, ${y})`;\n\n      const bboxes = calcLayout(\n        this.getAvailableSpace(),\n        this.children.map((child) => (child as DisplayObject).getBBox()),\n        this.attributes\n      );\n\n      this.children.forEach((child, index) => {\n        const { x, y } = bboxes[index];\n        child.style.transform = `translate(${x}, ${y})`;\n      });\n    } catch (e) {\n      // do nothing\n    }\n  }\n\n  bindEvents() {\n    this.layoutEvents.forEach((event) => {\n      this.addEventListener(event, (e: FederatedEvent) => {\n        if (!e.target) return;\n        (e.target as DisplayObject).isMutationObserved = true;\n        this.layout();\n      });\n    });\n  }\n\n  attributeChangedCallback(name: string, oldValue: any, newValue: any) {\n    if (name === 'margin') this.margin = newValue;\n    else if (name === 'padding') this.padding = newValue;\n    this.layout();\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}