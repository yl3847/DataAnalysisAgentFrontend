{"ast":null,"code":"import { prettyNumber } from '../utils/pretty-number';\n/**\n * 创建分割点\n * @param min 左区间\n * @param max 右区间\n * @param n 分割点个数\n * @returns 计算后的 ticks\n * @see R pretty https://svn.r-project.org/R/trunk/src/appl/pretty.c\n * @see R pretty https://www.rdocumentation.org/packages/base/versions/3.5.2/topics/pretty\n */\nexport const rPretty = (min, max, m = 5) => {\n  if (min === max) {\n    return [min];\n  }\n  const n = m < 0 ? 0 : Math.round(m);\n  if (n === 0) return [];\n  // high.u.bias\n  const h = 1.5;\n  // u5.bias\n  const h5 = 0.5 + 1.5 * h;\n  // 反正我也不会调参，跳过所有判断步骤\n  const d = max - min;\n  const c = d / n;\n  // 当d非常小的时候触发，但似乎没什么用\n  // const min_n = Math.floor(n / 3);\n  // const shrink_sml = Math.pow(2, 5);\n  // if (Math.log10(d) < -2) {\n  //   c = (_.max([ Math.abs(max), Math.abs(min) ]) * shrink_sml) / min_n;\n  // }\n  const base = 10 ** Math.floor(Math.log10(c));\n  let unit = base;\n  if (2 * base - c < h * (c - unit)) {\n    unit = 2 * base;\n    if (5 * base - c < h5 * (c - unit)) {\n      unit = 5 * base;\n      if (10 * base - c < h * (c - unit)) {\n        unit = 10 * base;\n      }\n    }\n  }\n  const nu = Math.ceil(max / unit);\n  const ns = Math.floor(min / unit);\n  const hi = Math.max(nu * unit, max);\n  const lo = Math.min(ns * unit, min);\n  const size = Math.floor((hi - lo) / unit) + 1;\n  const ticks = new Array(size);\n  for (let i = 0; i < size; i += 1) {\n    ticks[i] = prettyNumber(lo + i * unit);\n  }\n  return ticks;\n};","map":{"version":3,"names":["prettyNumber","rPretty","min","max","m","n","Math","round","h","h5","d","c","base","floor","log10","unit","nu","ceil","ns","hi","lo","size","ticks","Array","i"],"sources":["tick-methods/r-pretty.ts"],"sourcesContent":[null],"mappings":"AACA,SAASA,YAAY,QAAQ,wBAAwB;AAErD;;;;;;;;;AASA,OAAO,MAAMC,OAAO,GAAeA,CAACC,GAAG,EAAEC,GAAG,EAAEC,CAAC,GAAG,CAAC,KAAI;EACrD,IAAIF,GAAG,KAAKC,GAAG,EAAE;IACf,OAAO,CAACD,GAAG,CAAC;;EAGd,MAAMG,CAAC,GAAGD,CAAC,GAAG,CAAC,GAAG,CAAC,GAAGE,IAAI,CAACC,KAAK,CAACH,CAAC,CAAC;EACnC,IAAIC,CAAC,KAAK,CAAC,EAAE,OAAO,EAAE;EAEtB;EACA,MAAMG,CAAC,GAAG,GAAG;EACb;EACA,MAAMC,EAAE,GAAG,GAAG,GAAG,GAAG,GAAGD,CAAC;EACxB;EACA,MAAME,CAAC,GAAGP,GAAG,GAAGD,GAAG;EACnB,MAAMS,CAAC,GAAGD,CAAC,GAAGL,CAAC;EAEf;EACA;EACA;EACA;EACA;EACA;EAEA,MAAMO,IAAI,GAAG,EAAE,IAAIN,IAAI,CAACO,KAAK,CAACP,IAAI,CAACQ,KAAK,CAACH,CAAC,CAAC,CAAC;EAC5C,IAAII,IAAI,GAAGH,IAAI;EACf,IAAI,CAAC,GAAGA,IAAI,GAAGD,CAAC,GAAGH,CAAC,IAAIG,CAAC,GAAGI,IAAI,CAAC,EAAE;IACjCA,IAAI,GAAG,CAAC,GAAGH,IAAI;IACf,IAAI,CAAC,GAAGA,IAAI,GAAGD,CAAC,GAAGF,EAAE,IAAIE,CAAC,GAAGI,IAAI,CAAC,EAAE;MAClCA,IAAI,GAAG,CAAC,GAAGH,IAAI;MACf,IAAI,EAAE,GAAGA,IAAI,GAAGD,CAAC,GAAGH,CAAC,IAAIG,CAAC,GAAGI,IAAI,CAAC,EAAE;QAClCA,IAAI,GAAG,EAAE,GAAGH,IAAI;;;;EAItB,MAAMI,EAAE,GAAGV,IAAI,CAACW,IAAI,CAACd,GAAG,GAAGY,IAAI,CAAC;EAChC,MAAMG,EAAE,GAAGZ,IAAI,CAACO,KAAK,CAACX,GAAG,GAAGa,IAAI,CAAC;EAEjC,MAAMI,EAAE,GAAGb,IAAI,CAACH,GAAG,CAACa,EAAE,GAAGD,IAAI,EAAEZ,GAAG,CAAC;EACnC,MAAMiB,EAAE,GAAGd,IAAI,CAACJ,GAAG,CAACgB,EAAE,GAAGH,IAAI,EAAEb,GAAG,CAAC;EAEnC,MAAMmB,IAAI,GAAGf,IAAI,CAACO,KAAK,CAAC,CAACM,EAAE,GAAGC,EAAE,IAAIL,IAAI,CAAC,GAAG,CAAC;EAC7C,MAAMO,KAAK,GAAG,IAAIC,KAAK,CAACF,IAAI,CAAC;EAC7B,KAAK,IAAIG,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,IAAI,EAAEG,CAAC,IAAI,CAAC,EAAE;IAChCF,KAAK,CAACE,CAAC,CAAC,GAAGxB,YAAY,CAACoB,EAAE,GAAGI,CAAC,GAAGT,IAAI,CAAC;;EAGxC,OAAOO,KAAK;AACd,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}