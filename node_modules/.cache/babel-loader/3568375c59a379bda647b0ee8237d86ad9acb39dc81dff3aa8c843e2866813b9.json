{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { max as d3max, min as d3min } from '@antv/vendor/d3-array';\nimport { applyStyle } from '../utils';\nimport { select } from '../../utils/selection';\nimport { HeatmapRenderer } from './renderer';\nfunction deleteKey(obj, fn) {\n  return Object.keys(obj).reduce((r, k) => {\n    const v = obj[k];\n    if (!fn(v, k)) r[k] = v;\n    return r;\n  }, {});\n}\nexport const Heatmap = (options, context) => {\n  const {\n      gradient,\n      opacity,\n      maxOpacity,\n      minOpacity,\n      blur,\n      useGradientOpacity\n    } = options,\n    style = __rest(options, [\"gradient\", \"opacity\", \"maxOpacity\", \"minOpacity\", \"blur\", \"useGradientOpacity\"]);\n  const {\n    coordinate,\n    createCanvas,\n    document\n  } = context;\n  return (points, value, defaults) => {\n    const {\n      transform\n    } = value;\n    const [width, height] = coordinate.getSize();\n    const data = points.map(p => ({\n      x: p[0],\n      y: p[1],\n      value: p[2],\n      radius: p[3]\n    }));\n    const min = d3min(points, p => p[2]);\n    const max = d3max(points, p => p[2]);\n    const options = {\n      gradient,\n      opacity,\n      minOpacity,\n      maxOpacity,\n      blur,\n      useGradientOpacity\n    };\n    const ctx = width && height ? HeatmapRenderer(width, height, min, max, data, deleteKey(options, v => v === undefined), createCanvas) : {\n      canvas: null\n    };\n    return select(document.createElement('image', {})).call(applyStyle, defaults).style('x', 0).style('y', 0).style('width', width).style('height', height).style('src', ctx.canvas.toDataURL()).style('transform', transform).call(applyStyle, style).node();\n  };\n};\nHeatmap.props = {\n  defaultMarker: 'point',\n  defaultEnterAnimation: 'fadeIn',\n  defaultUpdateAnimation: 'morphing',\n  defaultExitAnimation: 'fadeOut'\n};","map":{"version":3,"names":["max","d3max","min","d3min","applyStyle","select","HeatmapRenderer","deleteKey","obj","fn","Object","keys","reduce","r","k","v","Heatmap","options","context","gradient","opacity","maxOpacity","minOpacity","blur","useGradientOpacity","style","__rest","coordinate","createCanvas","document","points","value","defaults","transform","width","height","getSize","data","map","p","x","y","radius","ctx","undefined","canvas","createElement","call","toDataURL","node","props","defaultMarker","defaultEnterAnimation","defaultUpdateAnimation","defaultExitAnimation"],"sources":["/Users/yizelu/Desktop/mcp/frontend/node_modules/@antv/g2/src/shape/heatmap/heatmap.ts"],"sourcesContent":["import { max as d3max, min as d3min } from '@antv/vendor/d3-array';\nimport { applyStyle } from '../utils';\nimport { select } from '../../utils/selection';\nimport { ShapeComponent as SC } from '../../runtime';\nimport { HeatmapRenderer } from './renderer';\nimport type { HeatmapRendererOptions } from './renderer/types';\n\nexport type HeatmapOptions = HeatmapRendererOptions;\n\nfunction deleteKey(obj: any, fn: (v, k) => boolean) {\n  return Object.keys(obj).reduce((r, k) => {\n    const v = obj[k];\n    if (!fn(v, k)) r[k] = v;\n    return r;\n  }, {});\n}\n\nexport const Heatmap: SC<HeatmapOptions> = (options, context) => {\n  const {\n    gradient,\n    opacity,\n    maxOpacity,\n    minOpacity,\n    blur,\n    useGradientOpacity,\n    ...style\n  } = options;\n  const { coordinate, createCanvas, document } = context;\n  return (points: number[][], value, defaults) => {\n    const { transform } = value;\n    const [width, height] = coordinate.getSize();\n    const data = points.map((p: number[]) => ({\n      x: p[0],\n      y: p[1],\n      value: p[2],\n      radius: p[3],\n    }));\n\n    const min = d3min(points, (p) => p[2]);\n    const max = d3max(points, (p) => p[2]);\n\n    const options = {\n      gradient,\n      opacity,\n      minOpacity,\n      maxOpacity,\n      blur,\n      useGradientOpacity,\n    };\n    const ctx =\n      width && height\n        ? HeatmapRenderer(\n            width,\n            height,\n            min,\n            max,\n            data,\n            deleteKey(options, (v) => v === undefined),\n            createCanvas,\n          )\n        : { canvas: null };\n\n    return select(document.createElement('image', {}))\n      .call(applyStyle, defaults)\n      .style('x', 0)\n      .style('y', 0)\n      .style('width', width)\n      .style('height', height)\n      .style('src', ctx.canvas.toDataURL())\n      .style('transform', transform)\n      .call(applyStyle, style)\n      .node();\n  };\n};\n\nHeatmap.props = {\n  defaultMarker: 'point',\n  defaultEnterAnimation: 'fadeIn',\n  defaultUpdateAnimation: 'morphing',\n  defaultExitAnimation: 'fadeOut',\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}