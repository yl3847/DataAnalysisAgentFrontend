{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { select } from '../../utils/selection';\nimport { applyStyle } from '../../shape/utils';\nimport { isTranspose, isCircular } from '../../utils/coordinate';\nimport { camelCase } from '../../utils/string';\nimport { Advance } from '../text/advance';\nimport * as PositionProcessor from './position';\nfunction inferPosition(position, coordinate) {\n  if (position !== undefined) return position;\n  if (isCircular(coordinate)) return 'inside';\n  if (isTranspose(coordinate)) return 'right';\n  return 'top';\n}\nfunction getDefaultStyle(points, value, coordinate, theme, options, labels) {\n  // For non-series mark, calc position for label based on\n  // position and the bounds of shape.\n  const {\n    position\n  } = value;\n  const {\n    render\n  } = options;\n  const p = inferPosition(position, coordinate);\n  const labelType = render ? 'htmlLabel' : p === 'inside' ? 'innerLabel' : 'label';\n  const t = theme[labelType];\n  const v = Object.assign({}, t, value);\n  const processor = PositionProcessor[camelCase(p)];\n  if (!processor) {\n    throw new Error(`Unknown position: ${p}`);\n  }\n  return Object.assign(Object.assign({}, t), processor(p, points, v, coordinate, options, labels));\n}\n/**\n * Render normal label for each mark.\n * @todo Support position option: middle...\n */\nexport const Label = (options, context) => {\n  const {\n    coordinate,\n    theme\n  } = context;\n  const {\n    render\n  } = options;\n  return (points, value, style, labels) => {\n    const {\n        text,\n        x,\n        y,\n        transform: specifiedTS = '',\n        transformOrigin,\n        className = ''\n      } = value,\n      overrideStyle = __rest(value, [\"text\", \"x\", \"y\", \"transform\", \"transformOrigin\", \"className\"]);\n    const _a = getDefaultStyle(points, value, coordinate, theme, options, labels),\n      {\n        rotate = 0,\n        transform = ''\n      } = _a,\n      defaultStyle = __rest(_a, [\"rotate\", \"transform\"]);\n    return select(new Advance()).call(applyStyle, defaultStyle).style('text', `${text}`).style('className', `${className} g2-label`).style('innerHTML', render ? render(text, value.datum, value.index) : undefined).style('labelTransform', `${transform} rotate(${+rotate}) ${specifiedTS}`.trim()).style('labelTransformOrigin', transformOrigin).style('coordCenter', coordinate.getCenter()).call(applyStyle, overrideStyle).node();\n  };\n};\nLabel.props = {\n  defaultMarker: 'point'\n};","map":{"version":3,"names":["select","applyStyle","isTranspose","isCircular","camelCase","Advance","PositionProcessor","inferPosition","position","coordinate","undefined","getDefaultStyle","points","value","theme","options","labels","render","p","labelType","t","v","Object","assign","processor","Error","Label","context","style","text","x","y","transform","specifiedTS","transformOrigin","className","overrideStyle","__rest","_a","rotate","defaultStyle","call","datum","index","trim","getCenter","node","props","defaultMarker"],"sources":["/Users/yizelu/Desktop/mcp/frontend/node_modules/@antv/g2/src/shape/label/label.ts"],"sourcesContent":["import { Coordinate } from '@antv/coord';\nimport { select } from '../../utils/selection';\nimport { G2Theme, ShapeComponent as SC, Vector2 } from '../../runtime';\nimport { applyStyle } from '../../shape/utils';\nimport { isTranspose, isCircular } from '../../utils/coordinate';\nimport { camelCase } from '../../utils/string';\nimport { Advance } from '../text/advance';\nimport { LabelPosition } from './position/default';\nimport * as PositionProcessor from './position';\n\nexport type LabelOptions = {\n  /**\n   * Customize label with html string or element.\n   */\n  render: (text: string, datum: any, index: number) => string | HTMLElement;\n  [key: string]: any;\n};\n\nfunction inferPosition(position: LabelPosition, coordinate: Coordinate) {\n  if (position !== undefined) return position;\n  if (isCircular(coordinate)) return 'inside';\n  if (isTranspose(coordinate)) return 'right';\n  return 'top';\n}\n\nfunction getDefaultStyle(\n  points: Vector2[],\n  value: Record<string, any>,\n  coordinate: Coordinate,\n  theme: G2Theme,\n  options: LabelOptions,\n  labels: Vector2[][],\n): Record<string, any> {\n  // For non-series mark, calc position for label based on\n  // position and the bounds of shape.\n  const { position } = value;\n  const { render } = options;\n  const p = inferPosition(position, coordinate);\n  const labelType = render\n    ? 'htmlLabel'\n    : p === 'inside'\n    ? 'innerLabel'\n    : 'label';\n  const t = theme[labelType];\n  const v = Object.assign({}, t, value);\n  const processor = PositionProcessor[camelCase(p)];\n  if (!processor) {\n    throw new Error(`Unknown position: ${p}`);\n  }\n  return {\n    ...t,\n    ...processor(p, points, v, coordinate, options, labels),\n  };\n}\n\n/**\n * Render normal label for each mark.\n * @todo Support position option: middle...\n */\nexport const Label: SC<LabelOptions> = (options, context) => {\n  const { coordinate, theme } = context;\n  const { render } = options;\n  return (points, value, style, labels) => {\n    const {\n      text,\n      x,\n      y,\n      transform: specifiedTS = '',\n      transformOrigin,\n      className = '',\n      ...overrideStyle\n    } = value;\n    const {\n      rotate = 0,\n      transform = '',\n      ...defaultStyle\n    } = getDefaultStyle(points, value, coordinate, theme, options, labels);\n\n    return select(new Advance())\n      .call(applyStyle, defaultStyle)\n      .style('text', `${text}`)\n      .style('className', `${className} g2-label`)\n      .style(\n        'innerHTML',\n        render ? render(text, value.datum, value.index) : undefined,\n      )\n      .style(\n        'labelTransform',\n        `${transform} rotate(${+rotate}) ${specifiedTS}`.trim(),\n      )\n      .style('labelTransformOrigin', transformOrigin)\n      .style('coordCenter', coordinate.getCenter())\n      .call(applyStyle, overrideStyle)\n      .node();\n  };\n};\n\nLabel.props = {\n  defaultMarker: 'point',\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}