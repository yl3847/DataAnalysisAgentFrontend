{"ast":null,"code":"/**\n * @fileOverview quadTree\n * @author shiwu.wyy@antfin.com\n */\nexport default class QuadTree {\n  // each quadtree represents a quadrant and an aggregate body\n  // that represents all bodies inside the quadrant\n  constructor(param) {\n    /**\n     * (aggregated) body in this quad\n     * @type  {object}\n     */\n    this.body = null;\n    /**\n     * tree representing the northwest quadrant\n     * @type  {object}\n     */\n    this.quad = null;\n    this.NW = null;\n    this.NE = null;\n    this.SW = null;\n    this.SE = null;\n    /**\n     * threshold\n     * @type  {number}\n     */\n    this.theta = 0.5;\n    if (param != null) this.quad = param;\n  }\n  // insert a body(node) into the tree\n  insert(bo) {\n    // if this node does not contain a body, put the new body bo here\n    if (this.body == null) {\n      this.body = bo;\n      return;\n    }\n    // internal node\n    if (!this._isExternal()) {\n      // update mass info\n      this.body = this.body.add(bo);\n      // insert body into quadrant\n      this._putBody(bo);\n    } else {\n      // external node\n      // divide this region into four children\n      if (this.quad) {\n        this.NW = new QuadTree(this.quad.NW());\n        this.NE = new QuadTree(this.quad.NE());\n        this.SW = new QuadTree(this.quad.SW());\n        this.SE = new QuadTree(this.quad.SE());\n      }\n      // insert this body and bo\n      this._putBody(this.body);\n      this._putBody(bo);\n      // update the mass info\n      this.body = this.body.add(bo);\n    }\n  }\n  // inserts bo into a quad\n  // tslint:disable-next-line\n  _putBody(bo) {\n    if (!this.quad) return;\n    if (bo.in(this.quad.NW()) && this.NW) this.NW.insert(bo);else if (bo.in(this.quad.NE()) && this.NE) this.NE.insert(bo);else if (bo.in(this.quad.SW()) && this.SW) this.SW.insert(bo);else if (bo.in(this.quad.SE()) && this.SE) this.SE.insert(bo);\n  }\n  // tslint:disable-next-line\n  _isExternal() {\n    // four children are null\n    return this.NW == null && this.NE == null && this.SW == null && this.SE == null;\n  }\n  // update the forces\n  updateForce(bo) {\n    if (this.body == null || bo === this.body) {\n      return;\n    }\n    // if the current node is external\n    if (this._isExternal()) bo.addForce(this.body);\n    // internal nodes\n    else {\n      const s = this.quad ? this.quad.getLength() : 0;\n      const d = this.body.distanceTo(bo);\n      // b is far enough\n      if (s / d < this.theta) bo.addForce(this.body);else {\n        this.NW && this.NW.updateForce(bo);\n        this.NE && this.NE.updateForce(bo);\n        this.SW && this.SW.updateForce(bo);\n        this.SE && this.SE.updateForce(bo);\n      }\n    }\n  }\n}","map":{"version":3,"names":["QuadTree","constructor","param","body","quad","NW","NE","SW","SE","theta","insert","bo","_isExternal","add","_putBody","in","updateForce","addForce","s","getLength","d","distanceTo"],"sources":["../../src/force-atlas2/quad-tree.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}