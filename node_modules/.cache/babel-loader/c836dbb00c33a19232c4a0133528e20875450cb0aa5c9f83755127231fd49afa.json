{"ast":null,"code":"import { localIntervalMap } from './time-interval';\nimport { utcIntervalMap } from './utc-interval';\nimport { bisect } from './bisect';\nimport { tickStep } from './ticks';\nfunction chooseTickIntervals(utc) {\n  const intervalMap = utc ? utcIntervalMap : localIntervalMap;\n  const {\n    year,\n    month,\n    week,\n    day,\n    hour,\n    minute,\n    second,\n    millisecond\n  } = intervalMap;\n  const tickIntervals = [[second, 1], [second, 5], [second, 15], [second, 30], [minute, 1], [minute, 5], [minute, 15], [minute, 30], [hour, 1], [hour, 3], [hour, 6], [hour, 12], [day, 1], [day, 2], [week, 1], [month, 1], [month, 3], [year, 1]];\n  return {\n    tickIntervals,\n    year,\n    millisecond\n  };\n}\nexport function findTickInterval(start, stop, count, interval, utc) {\n  const lo = +start;\n  const hi = +stop;\n  const {\n    tickIntervals,\n    year,\n    millisecond\n  } = chooseTickIntervals(utc);\n  const getter = ([interval, count]) => interval.duration * count;\n  const targetCount = interval ? (hi - lo) / interval : count || 5;\n  const targetInterval = interval || (hi - lo) / targetCount;\n  const len = tickIntervals.length;\n  const i = bisect(tickIntervals, targetInterval, 0, len, getter);\n  let matchInterval;\n  if (i === len) {\n    const step = tickStep(lo / year.duration, hi / year.duration, targetCount);\n    matchInterval = [year, step];\n  } else if (i) {\n    const closeToLow = targetInterval / getter(tickIntervals[i - 1]) < getter(tickIntervals[i]) / targetInterval;\n    const [timeInterval, targetStep] = closeToLow ? tickIntervals[i - 1] : tickIntervals[i];\n    const step = interval ? Math.ceil(interval / timeInterval.duration) : targetStep;\n    matchInterval = [timeInterval, step];\n  } else {\n    const step = Math.max(tickStep(lo, hi, targetCount), 1);\n    matchInterval = [millisecond, step];\n  }\n  return matchInterval;\n}","map":{"version":3,"names":["localIntervalMap","utcIntervalMap","bisect","tickStep","chooseTickIntervals","utc","intervalMap","year","month","week","day","hour","minute","second","millisecond","tickIntervals","findTickInterval","start","stop","count","interval","lo","hi","getter","duration","targetCount","targetInterval","len","length","i","matchInterval","step","closeToLow","timeInterval","targetStep","Math","ceil","max"],"sources":["utils/find-tick-interval.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}