{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { min as d3Min, max as d3Max, quantile, group } from '@antv/vendor/d3-array';\nimport { subObject } from '../utils/helper';\nimport { maybeAnimation, subTooltip } from '../utils/mark';\nfunction min(I, V) {\n  return d3Min(I, i => V[i]);\n}\nfunction max(I, V) {\n  return d3Max(I, i => V[i]);\n}\nfunction lower(I, V) {\n  const lo = q1(I, V) * 2.5 - q3(I, V) * 1.5;\n  return d3Min(I, i => V[i] >= lo ? V[i] : NaN);\n}\nfunction q1(I, V) {\n  return quantile(I, 0.25, i => V[i]);\n}\nfunction q2(I, V) {\n  return quantile(I, 0.5, i => V[i]);\n}\nfunction q3(I, V) {\n  return quantile(I, 0.75, i => V[i]);\n}\nfunction upper(I, V) {\n  const hi = q3(I, V) * 2.5 - q1(I, V) * 1.5;\n  return d3Max(I, i => V[i] <= hi ? V[i] : NaN);\n}\n/**\n * Group marks by x and reserve outlier indexes.\n */\nfunction OutlierY() {\n  return (I, mark) => {\n    const {\n      encode\n    } = mark;\n    const {\n      y,\n      x\n    } = encode;\n    const {\n      value: V\n    } = y;\n    const {\n      value: X\n    } = x;\n    const GI = Array.from(group(I, i => X[+i]).values());\n    const FI = GI.flatMap(I => {\n      const lo = lower(I, V);\n      const hi = upper(I, V);\n      return I.filter(i => V[i] < lo || V[i] > hi);\n    });\n    return [FI, mark];\n  };\n}\nexport const Boxplot = options => {\n  const {\n      data,\n      encode,\n      style = {},\n      tooltip = {},\n      transform,\n      animate\n    } = options,\n    rest = __rest(options, [\"data\", \"encode\", \"style\", \"tooltip\", \"transform\", \"animate\"]);\n  const {\n      point = true\n    } = style,\n    restStyle = __rest(style, [\"point\"]);\n  const {\n    y\n  } = encode;\n  const encodeY = {\n    y,\n    y1: y,\n    y2: y,\n    y3: y,\n    y4: y\n  };\n  const qy = {\n    y1: q1,\n    y2: q2,\n    y3: q3\n  };\n  // Tooltips.\n  const boxTooltip = subTooltip(tooltip, 'box', {\n    items: [{\n      channel: 'y',\n      name: 'min'\n    }, {\n      channel: 'y1',\n      name: 'q1'\n    }, {\n      channel: 'y2',\n      name: 'q2'\n    }, {\n      channel: 'y3',\n      name: 'q3'\n    }, {\n      channel: 'y4',\n      name: 'max'\n    }]\n  }, true);\n  const pointTooltip = subTooltip(tooltip, 'point', {\n    title: {\n      channel: 'x'\n    },\n    items: [{\n      name: 'outlier',\n      channel: 'y'\n    }]\n  });\n  // Only show min and max instead of lower and upper.\n  // Only draw a box.\n  if (!point) {\n    return Object.assign({\n      type: 'box',\n      data: data,\n      transform: [Object.assign(Object.assign({\n        type: 'groupX',\n        y: min\n      }, qy), {\n        y4: max\n      })],\n      encode: Object.assign(Object.assign({}, encode), encodeY),\n      style: restStyle,\n      tooltip: boxTooltip\n    }, rest);\n  }\n  const boxStyle = subObject(restStyle, 'box');\n  const pointStyle = subObject(restStyle, 'point');\n  return [Object.assign({\n    type: 'box',\n    data: data,\n    transform: [Object.assign(Object.assign({\n      type: 'groupX',\n      y: lower\n    }, qy), {\n      y4: upper\n    })],\n    encode: Object.assign(Object.assign({}, encode), encodeY),\n    style: boxStyle,\n    tooltip: boxTooltip,\n    animate: maybeAnimation(animate, 'box')\n  }, rest),\n  // Draw outliers.\n  {\n    type: 'point',\n    data: data,\n    transform: [{\n      type: OutlierY\n    }],\n    encode,\n    style: Object.assign({}, pointStyle),\n    tooltip: pointTooltip,\n    animate: maybeAnimation(animate, 'point')\n  }];\n};\nBoxplot.props = {};","map":{"version":3,"names":["min","d3Min","max","d3Max","quantile","group","subObject","maybeAnimation","subTooltip","I","V","i","lower","lo","q1","q3","NaN","q2","upper","hi","OutlierY","mark","encode","y","x","value","X","GI","Array","from","values","FI","flatMap","filter","Boxplot","options","data","style","tooltip","transform","animate","rest","__rest","point","restStyle","encodeY","y1","y2","y3","y4","qy","boxTooltip","items","channel","name","pointTooltip","title","Object","assign","type","boxStyle","pointStyle","props"],"sources":["/Users/yizelu/Desktop/mcp/frontend/node_modules/@antv/g2/src/mark/boxplot.ts"],"sourcesContent":["import {\n  min as d3Min,\n  max as d3Max,\n  quantile,\n  group,\n} from '@antv/vendor/d3-array';\nimport { CompositeMarkComponent as CC } from '../runtime';\nimport { BoxPlotMark } from '../spec';\nimport { subObject } from '../utils/helper';\nimport { maybeAnimation, subTooltip } from '../utils/mark';\n\nexport type BoxPlotOptions = Omit<BoxPlotMark, 'type'>;\n\nfunction min(I: number[], V: number[]): number {\n  return d3Min(I, (i) => V[i]);\n}\n\nfunction max(I: number[], V: number[]): number {\n  return d3Max(I, (i) => V[i]);\n}\n\nfunction lower(I: number[], V: number[]): number {\n  const lo = q1(I, V) * 2.5 - q3(I, V) * 1.5;\n  return d3Min(I, (i) => (V[i] >= lo ? V[i] : NaN));\n}\n\nfunction q1(I: number[], V: number[]): number {\n  return quantile(I, 0.25, (i) => V[i]);\n}\n\nfunction q2(I: number[], V: number[]): number {\n  return quantile(I, 0.5, (i) => V[i]);\n}\n\nfunction q3(I: number[], V: number[]): number {\n  return quantile(I, 0.75, (i) => V[i]);\n}\n\nfunction upper(I: number[], V: number[]): number {\n  const hi = q3(I, V) * 2.5 - q1(I, V) * 1.5;\n  return d3Max(I, (i) => (V[i] <= hi ? V[i] : NaN));\n}\n\n/**\n * Group marks by x and reserve outlier indexes.\n */\nfunction OutlierY() {\n  return (I: number[], mark) => {\n    const { encode } = mark;\n    const { y, x } = encode;\n    const { value: V } = y;\n    const { value: X } = x;\n    const GI = Array.from(group(I, (i) => X[+i]).values());\n    const FI = GI.flatMap((I) => {\n      const lo = lower(I, V);\n      const hi = upper(I, V);\n      return I.filter((i) => V[i] < lo || V[i] > hi);\n    });\n    return [FI, mark];\n  };\n}\n\nexport const Boxplot: CC<BoxPlotOptions> = (options) => {\n  const {\n    data,\n    encode,\n    style = {},\n    tooltip = {},\n    transform,\n    animate,\n    ...rest\n  } = options;\n  const { point = true, ...restStyle } = style;\n  const { y } = encode;\n  const encodeY = { y, y1: y, y2: y, y3: y, y4: y };\n  const qy = { y1: q1, y2: q2, y3: q3 };\n\n  // Tooltips.\n  const boxTooltip = subTooltip(\n    tooltip,\n    'box',\n    {\n      items: [\n        { channel: 'y', name: 'min' },\n        { channel: 'y1', name: 'q1' },\n        { channel: 'y2', name: 'q2' },\n        { channel: 'y3', name: 'q3' },\n        { channel: 'y4', name: 'max' },\n      ],\n    },\n    true,\n  );\n  const pointTooltip = subTooltip(tooltip, 'point', {\n    title: { channel: 'x' },\n    items: [{ name: 'outlier', channel: 'y' }],\n  });\n\n  // Only show min and max instead of lower and upper.\n  // Only draw a box.\n  if (!point) {\n    return {\n      type: 'box',\n      data: data,\n      transform: [\n        {\n          type: 'groupX',\n          y: min,\n          ...qy,\n          y4: max,\n        },\n      ],\n      encode: { ...encode, ...encodeY },\n      style: restStyle,\n      tooltip: boxTooltip,\n      ...rest,\n    };\n  }\n\n  const boxStyle = subObject(restStyle, 'box');\n  const pointStyle = subObject(restStyle, 'point');\n  return [\n    // Draw five-number box.\n    {\n      type: 'box',\n      data: data,\n      transform: [\n        {\n          type: 'groupX',\n          y: lower,\n          ...qy,\n          y4: upper,\n        },\n      ],\n      encode: { ...encode, ...encodeY },\n      style: boxStyle,\n      tooltip: boxTooltip,\n      animate: maybeAnimation(animate, 'box'),\n      ...rest,\n    },\n    // Draw outliers.\n    {\n      type: 'point',\n      data: data,\n      transform: [{ type: OutlierY }],\n      encode,\n      style: { ...pointStyle },\n      tooltip: pointTooltip,\n      animate: maybeAnimation(animate, 'point'),\n    },\n  ];\n};\n\nBoxplot.props = {};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}